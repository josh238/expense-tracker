<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
</head>
<body>
    <body>
   <h1>ðŸ’° Expense Tracker</h1>

  <!-- Add Expense Form -->
  <form id="expenseForm">
    <input type="text" id="title" placeholder="Title" required>
    <input type="number" id="amount" placeholder="Amount" required>
    <input type="text" id="category" placeholder="Category" required>
    <button type="submit">Add Expense</button>
  </form>

  <h2>All Expenses</h2>
  <ul id="expensesList"></ul>

  <script>
    const API_URL = "/api/expenses"; // since same server

    // Load all expenses
    async function fetchExpenses() {
      const res = await fetch(API_URL);
      const data = await res.json();
      const list = document.getElementById("expensesList");
      list.innerHTML = "";
      data.forEach(exp => {
        const li = document.createElement("li");
        li.textContent = `${exp.title} - $${exp.amount} [${exp.category}]`;

        // / Delete button
  const delBtn = document.createElement("button");
  delBtn.textContent = "Delete";
  delBtn.onclick = async () => {
    await fetch(`${API_URL}/${exp.id}`, { method: "DELETE" });
    fetchExpenses();
  };

  // Edit button
  const editBtn = document.createElement("button");
  editBtn.textContent = "Edit";
  editBtn.onclick = async () => {
    const newTitle = prompt("Enter new title:", exp.title);
    const newAmount = prompt("Enter new amount:", exp.amount);
    const newCategory = prompt("Enter new category:", exp.category);

    if (newTitle && newAmount && newCategory) {
      await fetch(`${API_URL}/${exp.id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          title: newTitle,
          amount: parseFloat(newAmount),
          category: newCategory
        })
      });
      fetchExpenses();
    }
  };

  li.appendChild(editBtn);
  li.appendChild(delBtn);
        list.appendChild(li);
      });
    }

    // Handle form submit
    document.getElementById("expenseForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const title = document.getElementById("title").value;
      const amount = document.getElementById("amount").value;
      const category = document.getElementById("category").value;

      await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ title, amount, category })
      });

      // reset form + reload list
      e.target.reset();
      fetchExpenses();
    });

    // Load on page start
    fetchExpenses();
  </script>
</body>
</html>